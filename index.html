<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-SJ5CP8DCH9"></script>
        <script>
         window.dataLayer = window.dataLayer || [];
         function gtag(){dataLayer.push(arguments);}
         gtag('js', new Date());

         gtag('config', 'G-SJ5CP8DCH9');
        </script>
        <!-- Standard Meta -->
        <meta charset="utf-8" />
        <meta name="author" content="Vito Van"/>
        <meta name="theme-color" content="#005797">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
        <link href=favicon.ico rel=icon type=image/x-icon>
        <style>
body{
    display: flex;
    justify-content: center;
    font-family: Optima, Palatino, Charter, 'Bitstream Charter', serif;
    color: #000;
    background: #F0F1EE none repeat scroll 0% 0%;
    font-size: 12pt;
    clear: both;
    padding: 0;
    margin: 0;
}
*{
    margin: 0;
    padding: 0;
}
.giscus {
    margin-top: 40px;
}
.container{
    float: left;
    width: 840px;
    padding: 20px;
}
.container img{
  border-radius: 4px;
  vertical-align: middle;
}
.panel{
    float: left;
    padding: 2em 0.9em;
    line-height: 1.2em;
    min-height: 20em;
    margin-right: 1em;
    border-right-color: blue;
    border-right-style: dashed;
    border-right-width: 0.1em;
}
.panel>ul{
    list-style:none;
}
.panel a{
    text-decoration: none;
    color: blue;
    display: block;
}
.panel>ul>li{
    margin-bottom: 0.9em;
}
.panel>ul>li.current>a{
    text-decoration: underline;
}
.panel a:hover{
    text-decoration: underline;
}
@media (max-width: 840px) {
    body {
      display: block;
    }
    .panel {
        padding: 0.9em 0.2em;
        min-height: 1em;
        width: 95%;
        border-right: none;
        border-bottom-color: blue;
        border-bottom-style: dashed;
        border-bottom-width: 0.1em;
    }
    .panel>ul>li {
        float: left;
        margin: 0 0.8em;
    }
    .container {
        width: 100%;
        padding: 0;
    }
    .markdown-body{
        min-width: inherit !important;
        border-radius: 0 !important;
    }
    .giscus {
        padding: 1%;
        width: 98%;
    }
}
.head{
    padding: 1em;
    text-transform: uppercase;
}
.head>h1>a{
    color: #888;
    text-decoration: none;
}
.content{
    padding:0 1em;
    font-size: 1em;
    line-height: 1.5em;
}
.index>a{
    display: block;
    line-height: 2em;
}
.index>li{
    margin: 0.5em 0;
    list-style-type: circle;
}
.index>li.shit{
  display: none;
}
.index>li.shit>a{
  opacity: .4;
  color: black;
}
.index>li.shit>a:visited{
  color: gray;
}
.markdown-body{
    background-color: white;
    padding: 1em;
    border-radius: 0.3em;
}

/* github-markdown.css */

.markdown-body {
  word-wrap: break-word;
}

.markdown-body a {
  background-color: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body strong {
  font-weight: bold;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
    font-family: Consolas,'Liberation Mono',Menlo,Courier,monospace;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type='checkbox'] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body * {
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px/1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, 'Segoe UI Emoji', 'Segoe UI Symbol';
}

.markdown-body a {
  color: blue;
}

.markdown-body a:link {
    text-decoration: none;
}

.markdown-body a:visited{
    color: #4078c0;
}


.markdown-body a:hover,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before {
  display: table;
  content: '';
}

.markdown-body hr:after {
  display: table;
  clear: both;
  content: '';
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body blockquote {
    margin: 0;
    line-height: 1em !important;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body .octicon {
  display: inline-block;
  text-decoration: none;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.markdown-body .octicon-link:before {
  content: '#';
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.markdown-body .anchor {
  position: absolute;
  top: 0;
  right: 0.5em;
  display: block;
  padding-right: 6px;
  padding-left: 30px;
  margin-left: -30px;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  position: relative;
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  line-height: 1.4;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  display: none;
  color: #000;
  vertical-align: middle;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  padding-left: 8px;
  margin-left: -30px;
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  display: inline-block;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h1 .anchor {
  line-height: 1;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 .anchor {
  line-height: 1;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h3 .anchor {
  line-height: 1.2;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h4 .anchor {
  line-height: 1.2;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h5 .anchor {
  line-height: 1.1;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body h6 .anchor {
  line-height: 1.1;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  box-sizing: border-box;
}

.markdown-body code {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: '\00a0';
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .highlight pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

.markdown-body kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb;
}

.markdown-body .pl-c {
  color: #969896;
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
  color: #0086b3;
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: #795da3;
}

.markdown-body .pl-s .pl-s1,
.markdown-body .pl-smi {
  color: #333;
}

.markdown-body .pl-ent {
  color: #63a35c;
}

.markdown-body .pl-k {
  color: #a71d5d;
}

.markdown-body .pl-pds,
.markdown-body .pl-s,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sra,
.markdown-body .pl-sr .pl-sre {
  color: #183691;
}

.markdown-body .pl-v {
  color: #ed6a43;
}

.markdown-body .pl-id {
  color: #b52a1d;
}

.markdown-body .pl-ii {
  background-color: #b52a1d;
  color: #f8f8f8;
}

.markdown-body .pl-sr .pl-cce {
  color: #63a35c;
  font-weight: bold;
}

.markdown-body .pl-ml {
  color: #693a17;
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  color: #1d3e81;
  font-weight: bold;
}

.markdown-body .pl-mq {
  color: #008080;
}

.markdown-body .pl-mi {
  color: #333;
  font-style: italic;
}

.markdown-body .pl-mb {
  color: #333;
  font-weight: bold;
}

.markdown-body .pl-md {
  background-color: #ffecec;
  color: #bd2c00;
}

.markdown-body .pl-mi1 {
  background-color: #eaffea;
  color: #55a532;
}

.markdown-body .pl-mdr {
  color: #795da3;
  font-weight: bold;
}

.markdown-body .pl-mo {
  color: #1d3e81;
}

.markdown-body kbd {
  display: inline-block;
  padding: 3px 5px;
  font: 11px Consolas, 'Liberation Mono', Menlo, Courier, monospace;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 0.35em 0.25em -1.6em;
  vertical-align: middle;
}

.markdown-body :checked+.radio-label {
  z-index: 1;
  position: relative;
  border-color: #4078c0;
}
</style>
        <title>CALM - Canvas Aided Lisp Magic</title>
    </head>
    <body>
        <div class="container">
            <div class="content markdown-body"><h1><a name="-c-a-l-m" class="anchor" aria-hidden="true" href="#-c-a-l-m"><span aria-hidden="true" class="octicon octicon-link"></span></a>
<a target="_blank" rel="noopener noreferrer" href="docs/images/calm.png"><img width="100" alt="Calm" src="docs/images/calm.png" style="max-width: 100%;"></a> C A L M</h1>
<p><a href="https://github.com/VitoVan/calm/actions/workflows/calm.yml"><img src="https://github.com/VitoVan/calm/actions/workflows/calm.yml/badge.svg" alt="CI" style="max-width: 100%;"></a> <a href="#pre-built-binary"><img src="https://camo.githubusercontent.com/073b059c9d315a3a86cd7a973299fc54d611cba05f758ebc9c1ac42ef851a872/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f646f776e6c6f6164732f7669746f76616e2f63616c6d2f746f74616c3f636f6c6f723d627269676874677265656e266c6162656c3d446f776e6c6f616473267374796c653d666c6174" alt="GitHub all releases" data-canonical-src="https://img.shields.io/github/downloads/vitovan/calm/total?color=brightgreen&amp;label=Downloads&amp;style=flat" style="max-width: 100%;"></a> <a href="https://github.com/VitoVan/calm/releases/latest"><img src="https://camo.githubusercontent.com/1880ec715465b0212722803f28674f6c6bd04c229b2b6375fff35cbc668e520d/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f7669746f76616e2f63616c6d3f6c6162656c3d4c617465737426636f6c6f723d253233303035383936" alt="GitHub release (release name instead of tag name)" data-canonical-src="https://img.shields.io/github/v/release/vitovan/calm?label=Latest&amp;color=%23005896" style="max-width: 100%;"></a></p>
<p><strong>C</strong>anvas <strong>A</strong>ided <strong>L</strong>isp <strong>M</strong>agic: Create canvas-based applications with Lisp and distribute them on Linux, macOS, Windows, and the web.</p>
<h2><a name="hello-world" class="anchor" aria-hidden="true" href="#hello-world"><span aria-hidden="true" class="octicon octicon-link"></span></a>Hello, World!</h2>
<p>Find whatever directory, and create a file: <strong>canvas.lisp</strong></p>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defparameter</span> <span class="pl-smi">*color-list*</span> '((<span class="pl-c1">0.83</span> <span class="pl-c1">0.82</span> <span class="pl-c1">0.84</span>) (<span class="pl-c1">0.89</span> <span class="pl-c1">0.12</span> <span class="pl-c1">0.17</span>) (<span class="pl-c1">0.94</span> <span class="pl-c1">0.87</span> <span class="pl-c1">0.47</span>) (<span class="pl-c1">0</span> <span class="pl-c1">0.35</span> <span class="pl-c1">0.59</span>)))
(<span class="pl-k">defun</span> <span class="pl-en">draw</span> ()
  (c:set-operator :darken)
  (<span class="pl-k">dotimes</span> (i <span class="pl-c1">7</span>)
    (c:arc (+ <span class="pl-c1">72</span> (* (- (/ <span class="pl-smi">*calm-window-width*</span> <span class="pl-c1">5</span>) <span class="pl-c1">44</span>) i)) <span class="pl-c1">73</span> <span class="pl-c1">50</span> <span class="pl-c1">0</span> (* <span class="pl-c1">2</span> pi))
    (apply <span class="pl-c1">#'c:set-source-rgb</span> (nth (<span class="pl-k">if</span> (&gt;= i <span class="pl-c1">4</span>) (- i <span class="pl-c1">4</span>) i) <span class="pl-smi">*color-list*</span>))
    (c:fill-path)))</pre></div>
<p>Launch your terminal, cd to that directory, and enter the command:</p>
<div class="highlight highlight-source-shell"><pre>calm</pre></div>
<p><a href="#hello-world"><img src="docs/examples/circles/canvas.png" alt="Hello World" style="max-width: 100%;"></a></p>
<h2><a name="examples" class="anchor" aria-hidden="true" href="#examples"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h2>
<p align="center">
    <a href="https://vitovan.com/calm/1.1.1/fan/calm.html" rel="nofollow"><img width="250" alt="Fan" src="./docs/examples/fan/canvas.png" style="max-width: 100%;"></a>
    <a href="https://vitovan.com/calm/1.1.1/mondrian/calm.html" rel="nofollow"><img width="250" alt="Mondrian" src="./docs/examples/mondrian/canvas.png" style="max-width: 100%;"></a>
    <a href="https://vitovan.com/calm/1.1.1/meditator/calm.html" rel="nofollow"><img width="250" alt="Meditator" src="./docs/examples/meditator/canvas.png" style="max-width: 100%;"></a>
</p>
<p>Source files and binaries for the above examples are <a href="https://github.com/VitoVan/calm/tree/main/docs/examples">here</a> and <a href="https://github.com/VitoVan/calm/releases/tag/1.1.1">here</a>.</p>
<p>For more applications made with CALM, please check <a href="https://github.com/VitoVan/made-with-calm">Made with CALM</a>.</p>
<h2><a name="-installation" class="anchor" aria-hidden="true" href="#-installation"><span aria-hidden="true" class="octicon octicon-link"></span></a>
<a target="_blank" rel="noopener noreferrer" href="./docs/images/calm.png"><img width="50" alt="Calm Installer" src="./docs/images/calm.png" style="max-width: 100%;"></a> Installation</h2>
<h3><a name="pre-built-binary" class="anchor" aria-hidden="true" href="#pre-built-binary"><span aria-hidden="true" class="octicon octicon-link"></span></a>Pre-built Binary</h3>
<ol>
<li>
<p>Download</p>
<p><a href="https://github.com/VitoVan/calm/releases/latest/download/calm.tgz"><img src="https://camo.githubusercontent.com/ed1bb81167c5c35819b37ec4ccb8e689759fb1fe5abfab5fcfe5d2ea4e8d98b4/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c696e75782d676c696263253230322e33312b2d4646443033322e7376673f6c6f676f3d6c696e7578" alt="Linux Download" data-canonical-src="https://img.shields.io/badge/Linux-glibc%202.31+-FFD032.svg?logo=linux" style="max-width: 100%;"></a> <a href="https://github.com/VitoVan/calm/releases/latest/download/calm.macos-13.dmg"><img src="https://camo.githubusercontent.com/cf65fb0a6193ee1ab096e87da694f44de49f7e31c5a2e94301110bebcee79154/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6d61634f532d56656e747572612d626c61636b3f6c6f676f3d6170706c65" alt="macOS Ventura Download" data-canonical-src="https://img.shields.io/badge/macOS-Ventura-black?logo=apple" style="max-width: 100%;"></a> <a href="https://github.com/VitoVan/calm/releases/latest/download/calm.zip"><img src="https://camo.githubusercontent.com/29361ec2f5dc193be0ad8547adb61ef892f2ae1b2c18ee7cefde043af0e0d997/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f57696e646f77732d57696e646f777325323031302f31312d3031376664352e7376673f6c6f676f3d77696e646f7773" alt="Windows Download" data-canonical-src="https://img.shields.io/badge/Windows-Windows%2010/11-017fd5.svg?logo=windows" style="max-width: 100%;"></a> <a href="https://github.com/VitoVan/calm/releases/latest/download/calm.macos-12.dmg"><img src="https://camo.githubusercontent.com/572ad77cfb9e51b239bd15ff64da01fccbce29d1d289fb87037fbc75e18fb661/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6d61634f532d4d6f6e74657265792d77686974653f6c6f676f3d6170706c65" alt="macOS Monterey Download" data-canonical-src="https://img.shields.io/badge/macOS-Monterey-white?logo=apple" style="max-width: 100%;"></a> <a href="https://github.com/VitoVan/calm/releases/latest/download/calm.macos-11.dmg"><img src="https://camo.githubusercontent.com/329f06498dd83b70a59107e4d194fdcf4e002cfa355bcc75e4300c01214925ea/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6d61634f532d4269672532305375722d77686974653f6c6f676f3d6170706c65" alt="macOS Big Sur Download" data-canonical-src="https://img.shields.io/badge/macOS-Big%20Sur-white?logo=apple" style="max-width: 100%;"></a></p>
</li>
<li>
<p>Extract</p>
</li>
<li>
<p>Add the extracted directory into your PATH environment</p>
<p>for macOS, add <code>/path/to/Calm.app/Contents/MacOS/</code> instead</p>
</li>
</ol>
<p>For macOS and Windows users, you need to be smarter than <a href="https://duckduckgo.com/?q=how+to+bypass+smartscreen" rel="nofollow">Windows SmartScreen</a> or able to <a href="https://support.apple.com/guide/mac-help/open-a-mac-app-from-an-unidentified-developer-mh40616/mac" rel="nofollow">tame macOS</a> to use CALM. In case anything went wrong, here is an <a href="docs/installation.md">Installation Guide</a>.</p>
<h3><a name="run-from-source" class="anchor" aria-hidden="true" href="#run-from-source"><span aria-hidden="true" class="octicon octicon-link"></span></a>Run from Source</h3>
<p>Supported platforms are currently limited by <a href="https://github.com/actions/runner-images">Github Actions runner images</a>.</p>
<p>If your platforms are not supported, feel free to <a href="docs/hacking.md#run-from-source">Run from Source</a>.</p>
<h2><a name="-distribution" class="anchor" aria-hidden="true" href="#-distribution"><span aria-hidden="true" class="octicon octicon-link"></span></a>
<a target="_blank" rel="noopener noreferrer" href="./docs/images/app.png"><img width="50" alt="Calm Application" src="./docs/images/app.png" style="max-width: 100%;"></a> Distribution</h2>
<p>Launch your terminal, cd to the directory where the file <strong>canvas.lisp</strong> exists, enter the command:</p>
<div class="highlight highlight-source-shell"><pre>calm publish</pre></div>
<p>This command will generate different packages on different platforms:</p>
<p><strong>Linux: AppImage</strong></p>
<p><a target="_blank" rel="noopener noreferrer" href="./docs/images/linux-appimage.png"><img src="./docs/images/linux-appimage.png" alt="Linux AppImage" style="max-width: 100%;"></a></p>
<blockquote>
<p><strong>Note</strong></p>
<p>The fancy window icon doesn't show on Wayland, I don't know why.</p>
</blockquote>
<p><strong>macOS: Application Bundle</strong></p>
<p><a target="_blank" rel="noopener noreferrer" href="./docs/images/macos-dmg.png"><img src="./docs/images/macos-dmg.png" alt="macOS Application DMG" style="max-width: 100%;"></a></p>
<blockquote>
<p><strong>Note</strong></p>
<p>DMG creation is powered by <a href="https://github.com/create-dmg/create-dmg">create-dmg</a> and will be installed by <code>brew install create-dmg</code> if it were not present. So if you don't have create-dmg, this will install create-dmg for you.</p>
<p>And, if you don't have <a href="https://brew.sh/" rel="nofollow">Homebrew</a>, this will also install Homebrew for you.</p>
<p>The binary detection was done by <code>command -v create-dmg</code> and <code>command -v brew</code>.</p>
</blockquote>
<p><strong>Windows: Installer</strong></p>
<p><a target="_blank" rel="noopener noreferrer" href="./docs/images/windows-installer.png"><img src="./docs/images/windows-installer.png" alt="Windows Installer" style="max-width: 100%;"></a></p>
<blockquote>
<p><strong>Note</strong></p>
<p>Installer creation is powered by <a href="https://nsis.sourceforge.io/" rel="nofollow">NSIS</a> and will be installed by <code>winget install nsis</code> if it were not present. So if you don't have NSIS (i.e., <code>makensis</code>) under your PATH, this will install NSIS for you.</p>
<p>And, if you don't have <a href="https://github.com/microsoft/winget-cli">winget</a> under your PATH, this will also install winget for you.</p>
<p>The binary detection was done by <code>where makensis</code> and <code>where winget</code>.</p>
</blockquote>
<h3><a name="to-the-web" class="anchor" aria-hidden="true" href="#to-the-web"><span aria-hidden="true" class="octicon octicon-link"></span></a>To the Web</h3>
<div class="highlight highlight-source-shell"><pre>calm publish-web</pre></div>
<p>This command could compile your Lisp code into web pages that could be served on the internet.</p>
<p>For more, please refer to the <a href="#command-reference">Command Reference</a>.</p>
<h1><a name="calm---references" class="anchor" aria-hidden="true" href="#calm---references"><span aria-hidden="true" class="octicon octicon-link"></span></a>CALM - References</h1>
<p>From CALM 1.0.0, the version number will follow <a href="https://semver.org/spec/v2.0.0.html" rel="nofollow">Semantic Versioning Specification</a>. This means you can use CALM calmly without worrying about me being crazy. Because whenever I'm going to be crazy, I will let you know <a href="https://semver.org/spec/v2.0.0.html#spec-item-7" rel="nofollow">before anything got changed</a> and bump the major version if <a href="https://semver.org/spec/v2.0.0.html#spec-item-8" rel="nofollow">anything could surprise</a> you.</p>
<p>Keep CALM and have fun.</p>
<h2><a name="command-reference" class="anchor" aria-hidden="true" href="#command-reference"><span aria-hidden="true" class="octicon octicon-link"></span></a>Command Reference</h2>
<h3><a name="calm" class="anchor" aria-hidden="true" href="#calm"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>calm</code></h3>
<p>You should run this command inside your project directory, where the file <strong>canvas.lisp</strong> should exist.</p>
<p>This command will load <strong>canvas.lisp</strong> and show a window according to the instructions of the function  <code>draw</code> or <code>draw-forever</code>. The file <strong>canvas.lisp</strong> is just a regular Lisp source file, you do whatever you like in it.</p>
<p>For CALM-related functions and parameters, please refer to the <a href="#api-reference">API Reference</a>.</p>
<h3><a name="calm-hello" class="anchor" aria-hidden="true" href="#calm-hello"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>calm hello</code></h3>
<p>This command will create a sample application with the default directory structure. You should create a project directory first, such as:</p>
<div class="highlight highlight-source-shell"><pre>mkdir my-cool-app
<span class="pl-c1">cd</span> my-cool-app
calm hello</pre></div>
<p>You will have the following files and directories created:</p>
<pre lang="text"><code>.
├── assets
├── canvas.lisp
└── fonts
    └── fonts.conf
</code></pre>
<p>Files put into <strong>assets</strong> and <strong>fonts</strong> directories will be packed with your application during distribution. If you put your favorite font into the <strong>fonts</strong> directory, you will be able to use it inside your application.</p>
<p>For more about font usage, please refer to the <a href="#rendering-text">API Reference: Rendering Text</a>.</p>
<h3><a name="calm-publish" class="anchor" aria-hidden="true" href="#calm-publish"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>calm publish</code></h3>
<p>This command will generate:</p>
<ul>
<li>Linux AppImage</li>
<li>macOS Application Bundle inside DMG</li>
<li>Windows Application Installer</li>
</ul>
<p>according to the platform it was running on.</p>
<p>It does not take any arguments, but some options could be set through the environment variables, please check <code>calm publish-with-options</code> for the option details.</p>
<h3><a name="calm-publish-with-options" class="anchor" aria-hidden="true" href="#calm-publish-with-options"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>calm publish-with-options</code></h3>
<p>This command will do the same thing as <code>calm publish</code>, instead it will ask your opinions on all the customizable options (with a default value provided, don't worry), respectively:</p>
<table>
<thead>
<tr>
<th>OS</th>
<th>ENV</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Linux</td>
<td>APP_NAME</td>
<td>The name of the AppImage file</td>
</tr>
<tr>
<td>Linux</td>
<td>APP_ICON</td>
<td>Icon of the AppImage file and SDL2 Window, absolute path of a PNG file</td>
</tr>
<tr>
<td>macOS</td>
<td>APP_NAME</td>
<td>The name of the macOS Application bundle, will appear in the Launchpad</td>
</tr>
<tr>
<td>macOS</td>
<td>APP_ICON</td>
<td>macOS Application icon, absolute path of an ICNS file</td>
</tr>
<tr>
<td>macOS</td>
<td>BUNDLE_ID</td>
<td>
<a href="https://developer.apple.com/documentation/bundleresources/information_property_list/cfbundleidentifier" rel="nofollow">CFBundleIdentifier</a>, such as <code>com.vitovan.helloworld</code>
</td>
</tr>
<tr>
<td>macOS</td>
<td>APP_VERSION</td>
<td>
<a href="https://developer.apple.com/documentation/bundleresources/information_property_list/cfbundleshortversionstring" rel="nofollow">CFBundleShortVersionString</a>, such as: <code>10.14.1</code>
</td>
</tr>
<tr>
<td>macOS</td>
<td>DMG_ICON</td>
<td>The icon of the Apple Disk Image (DMG), absolute path of an ICNS file</td>
</tr>
<tr>
<td>Windows</td>
<td>APP_NAME</td>
<td>Windows Application Name, will appear in the <em>Control Panel &gt; Programs and Features</em>, <em>Apps &amp; features</em> and as the name of desktop shortcut</td>
</tr>
<tr>
<td>Windows</td>
<td>APP_ICON</td>
<td>Windows EXE icon, absolute path of an ICO file</td>
</tr>
<tr>
<td>All</td>
<td>DIST_DIR</td>
<td>The directory of generated binaries, normally it's <code>./dist</code>
</td>
</tr>
</tbody>
</table>
<p>If you have provided the corresponding environment variable, the option will not be asked. You could also set these environment variables while using the command <code>calm publish</code>, the options will be picked up.</p>
<h3><a name="calm-publish-web" class="anchor" aria-hidden="true" href="#calm-publish-web"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>calm publish-web</code></h3>
<p>This command will generate a  <strong>web</strong> directory containing all the necessary materials for you to serve it on the internet. The common usage could be like this:</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c1">cd</span> my-cool-app
calm publish-web</pre></div>
<p>You will have the following files created:</p>
<pre lang="text"><code>web
├── calm.data
├── calm.html
├── calm.js
├── calm.wasm
├── canvas.js
├── favicon.ico
└── jscl.js
</code></pre>
<p><strong>calm.html</strong> is the entry point, due to the limitation of the web browser, please view this file through HTTP protocol, such as:</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c1">cd</span> web
python3 -m http.server 8000</pre></div>
<p>Then open <a href="http://127.0.0.1:8000/calm.html" rel="nofollow">http://127.0.0.1:8000/calm.html</a> in your browser.</p>
<p>Note: The files inside <strong>fonts</strong> and <strong>assets</strong> directories will <em>NOT</em> be packed by default, please check the REBUILD_WASM_P option below.</p>
<h3><a name="calm-publish-web-with-options" class="anchor" aria-hidden="true" href="#calm-publish-web-with-options"><span aria-hidden="true" class="octicon octicon-link"></span></a><code>calm publish-web-with-options</code></h3>
<p>This command works like <code>calm publish-with-options</code> except it's for <code>calm publish-web</code>.</p>
<table>
<thead>
<tr>
<th>ENV</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>LISP_FILES</td>
<td>Code like <code>(load "shape.lisp")</code> may cause problems for the web application, since JSCL will try to load that file via HTTP requests. <br>If you need to include the extra files other than <strong>canvas.lisp</strong>, please modify your code to bypass JSCL, for example: <code>#-jscl (load "shape.lisp")</code> and then set this option, such as: <code>("/abs/path/to/canvas.lisp" "/abs/path/to/shape.lisp")</code>. Please remember to escape the double quotes if you're going to set the ENV.</td>
</tr>
<tr>
<td>REBUILD_WASM_P</td>
<td>By default WebAssembly files were not built locally, they were downloaded from the <a href="https://github.com/VitoVan/calm/releases/">CALM Releases</a>: <strong>calm.tar</strong>. This prebuilt WebAssembly binary bundled with <a href="https://github.com/googlefonts/opensans/raw/main/fonts/ttf/OpenSans-Regular.ttf">OpenSan-Regular.ttf</a> and <a href="https://github.com/VitoVan/calm/blob/main/s/usr/web/wasm.lisp#L61">exposed all the Cairo and SDL2 APIs</a> mentioned in the below <a href="#api-reference">API Reference</a> section.<br> If you need to bundle other <strong>fonts</strong> or <strong>assets</strong>, or you need to expose more C APIs be exposed to the web, please set this option to "yes". <br>Caution: Building WebAssembly binaries involves a whole lot of dependencies, to simplify this progress, I irresponsibly utilized docker. So, please make sure you have the <code>docker</code> command at your disposal.<br>Default: "no"</td>
</tr>
</tbody>
</table>
<p>Since JSCL is the backbone of CALM on the web, any change of JSCL will be considered as a change of CALM itself. The code base of JSCL used by each version of CALM is fixed, it won't change unless you update CALM. Please feel safe to use it.</p>
<h3><a name="api-reference" class="anchor" aria-hidden="true" href="#api-reference"><span aria-hidden="true" class="octicon octicon-link"></span></a>API Reference</h3>
<p>CALM is intended to be a thin layer above <a href="https://wiki.libsdl.org/SDL2/FrontPage" rel="nofollow">SDL2</a>, <a href="https://www.cairographics.org/" rel="nofollow">Cairo</a>, and some other things. So the number of APIs provided by CALM is intended to be as small as possible.</p>
<h4><a name="fundamentals" class="anchor" aria-hidden="true" href="#fundamentals"><span aria-hidden="true" class="octicon octicon-link"></span></a>Fundamentals</h4>
<h5><a name="file-canvaslisp" class="anchor" aria-hidden="true" href="#file-canvaslisp"><span aria-hidden="true" class="octicon octicon-link"></span></a>File <code>canvas.lisp</code>
</h5>
<p>This is the entry file for a CALM application. Typically, it should contain a function called <code>draw</code>.</p>
<h5><a name="function-draw" class="anchor" aria-hidden="true" href="#function-draw"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>draw</code>
</h5>
<p>This is the entry function for a CALM application, it will be called once the application started. You are supposed to call some canvas drawing functions to be shown, such as:</p>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">draw</span> ()
  (c:set-source-rgb <span class="pl-c1">1</span> <span class="pl-c1">0</span> <span class="pl-c1">0</span>)
  (c:arc <span class="pl-c1">200</span> <span class="pl-c1">73</span> <span class="pl-c1">50</span> <span class="pl-c1">0</span> (* <span class="pl-c1">2</span> pi))
  (c:fill-path))</pre></div>
<p>This function will be called passively. That is to say, this function won't be called again after the first call, unless any event has been triggered by the user, such as mouse motion, key down, key up, mouse button down, etc.</p>
<p>If you want to continually refresh the canvas without user interaction, you should use <code>draw-forever</code>.</p>
<p>Note: Functions like <code>c:arc</code> are third-party APIs exposed by CALM. Please refer to <a href="#drawing-on-canvas">Drawing on Canvas</a> for more info.</p>
<h5><a name="function-draw-forever" class="anchor" aria-hidden="true" href="#function-draw-forever"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>draw-forever</code>
</h5>
<p>This function also serves as the entry point for a CALM application, similar to the <code>draw</code> function. It is important to avoid defining both <code>draw</code> and <code>draw-forever</code> as doing so would have severe consequences, comparable to killing John Wick's dog.</p>
<p>This function will be called every <code>*calm-delay*</code> milliseconds, regardless of user interaction.</p>
<h5><a name="variable-calm-delay" class="anchor" aria-hidden="true" href="#variable-calm-delay"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-delay*</code>
</h5>
<p>This variable controls how many milliseconds CALM should wait before refreshing the canvas.</p>
<p>Default: 42</p>
<p>This variable only works on the desktop platform, for the web platform, please check <code>*calm-fps*</code>.</p>
<h5><a name="variable-calm-redraw" class="anchor" aria-hidden="true" href="#variable-calm-redraw"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-redraw*</code>
</h5>
<p>This variable controls if the canvas will be refreshed from now on.</p>
<p>Normally, you don't need to touch this variable. But if you are using <code>draw-forever</code> and you want to manually control the process of refreshing, it could be useful. Such as:</p>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defparameter</span> <span class="pl-smi">*game-started*</span> <span class="pl-c1">nil</span>)

(<span class="pl-k">defun</span> <span class="pl-en">on-keyup</span> (key)
  (<span class="pl-k">when</span> (c:keq key :SCANCODE-SPACE)
    (<span class="pl-c1">setf</span> <span class="pl-smi">*game-started*</span> (<span class="pl-k">not</span> <span class="pl-smi">*game-started*</span>))))

(<span class="pl-k">defun</span> <span class="pl-en">draw-forever</span> ()
  (<span class="pl-c1">format</span> <span class="pl-c1">t</span> <span class="pl-s"><span class="pl-pds">"</span>drawing canvas...~%<span class="pl-pds">"</span></span>)
  (c:set-source-rgb (/ <span class="pl-c1">12</span> <span class="pl-c1">255</span>) (/ <span class="pl-c1">55</span> <span class="pl-c1">255</span>) (/ <span class="pl-c1">132</span> <span class="pl-c1">255</span>))
  (c:paint)
  (c:set-source-rgb <span class="pl-c1">1</span> <span class="pl-c1">1</span> <span class="pl-c1">1</span>)
  (c:move-to <span class="pl-c1">70</span> <span class="pl-c1">90</span>)
  (c:select-font-family <span class="pl-s"><span class="pl-pds">"</span>Arial<span class="pl-pds">"</span></span> :normal :normal)
  (c:set-font-size <span class="pl-c1">60</span>)
  (c:show-text (<span class="pl-c1">format</span> <span class="pl-c1">nil</span> <span class="pl-s"><span class="pl-pds">"</span>Press SPACE: ~A<span class="pl-pds">"</span></span> (write-to-string (mod (c:get-ticks) <span class="pl-c1">9</span>))))
  (<span class="pl-c1">setf</span> <span class="pl-smi">*calm-redraw*</span> <span class="pl-smi">*game-started*</span>))</pre></div>
<p>Note: this variable will be set to <code>T</code> whenever a user event was triggered.</p>
<h5><a name="variable-calm-fps" class="anchor" aria-hidden="true" href="#variable-calm-fps"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-fps*</code>
</h5>
<p>This variable controls how many milliseconds CALM should wait before refreshing the canvas. Setting 0 will use the browser’s <code>requestAnimationFrame</code> mechanism to refresh the canvas.</p>
<p>Default: 42</p>
<p>This variable only works on the web, for the desktop platform, please check <code>*calm-delay*</code>.</p>
<h4><a name="drawing-on-canvas" class="anchor" aria-hidden="true" href="#drawing-on-canvas"><span aria-hidden="true" class="octicon octicon-link"></span></a>Drawing on Canvas</h4>
<p>Drawing in CALM could be achieved via <a href="https://www.cairographics.org/" rel="nofollow">Cairo</a>.</p>
<p>To know more about how to draw anything, please read <a href="https://www.cairographics.org/tutorial/" rel="nofollow">Cairo Tutorial</a> and <a href="https://www.cairographics.org/manual/" rel="nofollow">Cairo API</a>, most of the code could be modified to work in CALM.</p>
<p>For example:</p>
<div class="highlight highlight-source-c"><pre><span class="pl-en">cairo_set_line_width</span> (<span class="pl-s1">cr</span>, <span class="pl-c1">0.1</span>);
<span class="pl-en">cairo_set_source_rgb</span> (<span class="pl-s1">cr</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>);
<span class="pl-en">cairo_rectangle</span> (<span class="pl-s1">cr</span>, <span class="pl-c1">0.25</span>, <span class="pl-c1">0.25</span>, <span class="pl-c1">0.5</span>, <span class="pl-c1">0.5</span>);
<span class="pl-en">cairo_stroke</span> (<span class="pl-s1">cr</span>);</pre></div>
<p>is equivalent to</p>
<div class="highlight highlight-source-lisp"><pre>(c:set-line-width <span class="pl-c1">0.1</span>)
(c:set-source-rgb <span class="pl-c1">0</span> <span class="pl-c1">0</span> <span class="pl-c1">0</span>)
(c:rectangle <span class="pl-c1">0.25</span> <span class="pl-c1">0.25</span> <span class="pl-c1">0.5</span> <span class="pl-c1">0.5</span>)
(c:stroke)</pre></div>
<p>All the symbols <a href="https://github.com/rpav/cl-cairo2/blob/master/src/package.lisp#L7-L142">exported by cl-cairo2</a> should be accessible through <code>c:</code> prefix, such as: <code>c:arc</code>. On the web, the accessible symbols are limited by <a href="https://github.com/VitoVan/calm/blob/main/src/web/cairo.lisp#L266-L405">cairo.lisp</a>.</p>
<p>Since Cairo is the cardinal drawing facility of CALM, any change of Cairo-related symbols will be considered as a change of CALM itself. Please feel safe to use them.</p>
<h5><a name="function-crrectangle" class="anchor" aria-hidden="true" href="#function-crrectangle"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:rrectangle</code>
</h5>
<p>Draw a rounded rectangle.</p>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">draw</span> ()
  (c:set-source-rgb <span class="pl-c1">0</span> <span class="pl-c1">0</span> <span class="pl-c1">1</span>)
  (c:rrectangle <span class="pl-c1">20</span> <span class="pl-c1">20</span> <span class="pl-c1">100</span> <span class="pl-c1">100</span> :radius <span class="pl-c1">8</span>) <span class="pl-c"><span class="pl-c">;</span>; &lt;---- here</span>
  (c:fill-path))</pre></div>
<h5><a name="function-cshow-png" class="anchor" aria-hidden="true" href="#function-cshow-png"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:show-png</code>
</h5>
<p>Show a png file.</p>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">draw</span> ()
  (c:show-png <span class="pl-s"><span class="pl-pds">"</span>assets/calm.png<span class="pl-pds">"</span></span> <span class="pl-c1">20</span> <span class="pl-c1">20</span> <span class="pl-c1">100</span> <span class="pl-c1">100</span>))</pre></div>
<p>This function will stretch the png if needed.</p>
<h4><a name="rendering-text" class="anchor" aria-hidden="true" href="#rendering-text"><span aria-hidden="true" class="octicon octicon-link"></span></a>Rendering Text</h4>
<h5><a name="function-cselect-font-family" class="anchor" aria-hidden="true" href="#function-cselect-font-family"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:select-font-family</code>
</h5>
<p>This function will select a font to be used in <code>c:show-text</code>.</p>
<div class="highlight highlight-source-lisp"><pre>(c:select-font-family <span class="pl-s"><span class="pl-pds">"</span>Open Sans<span class="pl-pds">"</span></span> :normal :normal)</pre></div>
<p>It takes three arguments: <code>family</code>, <code>slant</code> and <code>weight</code>. For detailed example, please check <code>c:show-text</code>.</p>
<p>To use a custom font without installing it, just put it inside the <strong>fonts</strong> directory, relative to the file <strong>canvas.lisp</strong>.</p>
<h5><a name="function-cshow-text" class="anchor" aria-hidden="true" href="#function-cshow-text"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:show-text</code>
</h5>
<p>This function will show simple text.</p>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">draw</span> ()
  (c:move-to <span class="pl-c1">30</span> <span class="pl-c1">100</span>)
  (c:set-font-size <span class="pl-c1">84</span>)
  (c:select-font-family <span class="pl-s"><span class="pl-pds">"</span>Open Sans<span class="pl-pds">"</span></span> :italic :bold)
  (c:show-text <span class="pl-s"><span class="pl-pds">"</span>DON'T PANIC<span class="pl-pds">"</span></span>))</pre></div>
<h5><a name="function-cshow-markup" class="anchor" aria-hidden="true" href="#function-cshow-markup"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:show-markup</code>
</h5>
<p>This function will show <a href="https://docs.gtk.org/Pango/pango_markup.html" rel="nofollow">Pango Markup</a>.</p>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">draw</span> ()
  (c:move-to <span class="pl-c1">20</span> <span class="pl-c1">10</span>)
  (c:set-font-size <span class="pl-c1">84</span>)
  (c:show-markup <span class="pl-s"><span class="pl-pds">"</span>This is &lt;span fgcolor='#245791' weight='bold' face='Open Sans'&gt;SICK&lt;/span&gt;<span class="pl-pds">"</span></span>))</pre></div>
<p>Note that the coordinate system between <code>c:show-markup</code> and <code>c:show-text</code> are slightly different, so you may need to adjust the position a little if you switch between <code>c:show-markup</code> and <code>c:show-text</code>.</p>
<p>This function is not exposed to the web due to the following reasons:</p>
<ol>
<li>Pango requires multi-threading, which requires extra <a href="https://web.dev/coop-coep/" rel="nofollow">HTTP HEADERS</a> to be set</li>
<li>Compiling Pango into WebAssembly will increase the time and data for loading</li>
<li>Using Pango often involves extra fonts to be bundled, this will cause more data to be loaded</li>
</ol>
<p>So I don't think this is a good idea to include Pango by default, albeit it is easy to implement.</p>
<h4><a name="playing-sound" class="anchor" aria-hidden="true" href="#playing-sound"><span aria-hidden="true" class="octicon octicon-link"></span></a>Playing Sound</h4>
<h5><a name="function-cplay-wav" class="anchor" aria-hidden="true" href="#function-cplay-wav"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:play-wav</code>
</h5>
<p>Play a wav file.</p>
<p>If <code>c:play-wav</code> were called before, and the previous wav file was still playing, the sound will be merged together.</p>
<div class="highlight highlight-source-lisp"><pre>(c:play-wav <span class="pl-s"><span class="pl-pds">"</span>assets/ouch.ogg<span class="pl-pds">"</span></span> :loops <span class="pl-c1">0</span> :channel -<span class="pl-c1">1</span>)</pre></div>
<p>Set <code>:loops</code> to -1 means "infinitely" (~65000 times)</p>
<p>Set <code>:channel</code> to -1 means play on the first free channel</p>
<p>The maximum number of files playing at the same time is limited to the variable <code>*calm-audio-numchans*</code>.</p>
<h5><a name="variable-calm-audio-numchans" class="anchor" aria-hidden="true" href="#variable-calm-audio-numchans"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-audio-numchans*</code>
</h5>
<p>The maximum number of wav files being played at the same time.</p>
<p>Default: 8</p>
<h5><a name="function-cvolume-wav" class="anchor" aria-hidden="true" href="#function-cvolume-wav"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:volume-wav</code>
</h5>
<p>Set the volume of <code>c:play-wav</code>.</p>
<div class="highlight highlight-source-lisp"><pre>(c:volume-wav <span class="pl-c1">128</span> :channel -<span class="pl-c1">1</span>)</pre></div>
<p>The value should be between 0 (silence) and 128.</p>
<p>Set <code>:channel</code> to -1 means all channels.</p>
<h5><a name="function-chalt-wav" class="anchor" aria-hidden="true" href="#function-chalt-wav"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:halt-wav</code>
</h5>
<p>Stop playing a channel or all of them.</p>
<div class="highlight highlight-source-lisp"><pre>(c:halt-wav :channel -<span class="pl-c1">1</span>)</pre></div>
<p>Set <code>:channel</code> to -1 means all channels.</p>
<h5><a name="function-cplay-music" class="anchor" aria-hidden="true" href="#function-cplay-music"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:play-music</code>
</h5>
<p>Play a music file, it can play MP3, Ogg, and WAV.</p>
<p>Other types of files might also work, but they are not guaranteed by CALM.</p>
<div class="highlight highlight-source-lisp"><pre>(c:play-music <span class="pl-s"><span class="pl-pds">"</span>assets/bgm.ogg<span class="pl-pds">"</span></span> :loops <span class="pl-c1">0</span>)</pre></div>
<p>If <code>c:play-music</code> were called before, and the previous music was still playing, it will be stopped and the latest music will start playing.</p>
<h5><a name="function-cvolume-music" class="anchor" aria-hidden="true" href="#function-cvolume-music"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:volume-music</code>
</h5>
<p>Set the volume of <code>c:play-music</code>.</p>
<div class="highlight highlight-source-lisp"><pre>(c:volume-music <span class="pl-c1">128</span>)</pre></div>
<p>The value should be between 0 (silence) and 128.</p>
<h5><a name="function-chalt-music" class="anchor" aria-hidden="true" href="#function-chalt-music"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:halt-music</code>
</h5>
<p>Stop playing music.</p>
<h5><a name="function-cplay-audio" class="anchor" aria-hidden="true" href="#function-cplay-audio"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:play-audio</code>
</h5>
<p>Play an audio file, this function is only available on the web since it utilizes the <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLAudioElement" rel="nofollow">HTMLAudioElement</a>.</p>
<div class="highlight highlight-source-lisp"><pre>(c:play-audio <span class="pl-s"><span class="pl-pds">"</span>assets/meow.ogg<span class="pl-pds">"</span></span> :<span class="pl-k">loop</span>-audio-p <span class="pl-c1">nil</span> :volume <span class="pl-c1">1</span>)</pre></div>
<p><code>:volume</code> should be between 0 and 1.</p>
<h5><a name="function-chalt-audio" class="anchor" aria-hidden="true" href="#function-chalt-audio"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:halt-audio</code>
</h5>
<p>Stop playing one specific audio file or all of them.</p>
<div class="highlight highlight-source-lisp"><pre>(c:halt-audio <span class="pl-s"><span class="pl-pds">"</span>assets/purr.ogg<span class="pl-pds">"</span></span>)</pre></div>
<p>If call it without any arguments, it stops all the playing audio.</p>
<h4><a name="internal-states" class="anchor" aria-hidden="true" href="#internal-states"><span aria-hidden="true" class="octicon octicon-link"></span></a>Internal States</h4>
<h5><a name="variable-calm-state-mouse-x" class="anchor" aria-hidden="true" href="#variable-calm-state-mouse-x"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-state-mouse-x*</code>
</h5>
<h5><a name="variable-calm-state-mouse-y" class="anchor" aria-hidden="true" href="#variable-calm-state-mouse-y"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-state-mouse-y*</code>
</h5>
<h5><a name="variable-calm-state-mouse-up" class="anchor" aria-hidden="true" href="#variable-calm-state-mouse-up"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-state-mouse-up*</code>
</h5>
<h5><a name="variable-calm-state-mouse-down" class="anchor" aria-hidden="true" href="#variable-calm-state-mouse-down"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-state-mouse-down*</code>
</h5>
<h5><a name="variable-calm-state-mouse-just-clicked" class="anchor" aria-hidden="true" href="#variable-calm-state-mouse-just-clicked"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-state-mouse-just-clicked*</code>
</h5>
<h5><a name="variable-calm-state-finger-x" class="anchor" aria-hidden="true" href="#variable-calm-state-finger-x"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-state-finger-x*</code>
</h5>
<h5><a name="variable-calm-state-finger-y" class="anchor" aria-hidden="true" href="#variable-calm-state-finger-y"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-state-finger-y*</code>
</h5>
<h5><a name="variable-calm-state-finger-just-tapped" class="anchor" aria-hidden="true" href="#variable-calm-state-finger-just-tapped"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-state-finger-just-tapped*</code>
</h5>
<p>The above variables hold the state of the mouse and finger (touch device, like the mobile web browser), they are read-only. The consequence of <code>(setf *calm-state-mouse-x* 20)</code> is equivalent to drinking bleach.</p>
<h5><a name="function-cget-ticks" class="anchor" aria-hidden="true" href="#function-cget-ticks"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:get-ticks</code>
</h5>
<p>This is just <a href="https://wiki.libsdl.org/SDL2/SDL_GetTicks" rel="nofollow">SDL_GetTicks</a>.</p>
<h4><a name="event-callbacks" class="anchor" aria-hidden="true" href="#event-callbacks"><span aria-hidden="true" class="octicon octicon-link"></span></a>Event Callbacks</h4>
<p>These callbacks are functions that you should define. If you defined any of them, they will be called when the corresponding event was triggered.</p>
<h5><a name="callback-on-keydown" class="anchor" aria-hidden="true" href="#callback-on-keydown"><span aria-hidden="true" class="octicon octicon-link"></span></a>Callback <code>on-keydown</code>
</h5>
<h5><a name="callback-on-keyup" class="anchor" aria-hidden="true" href="#callback-on-keyup"><span aria-hidden="true" class="octicon octicon-link"></span></a>Callback <code>on-keyup</code>
</h5>
<p>You know what these callbacks do, what you don't know is their should-be arguments. Please check <code>c:keq</code> for a detailed example.</p>
<h5><a name="function-ckeq" class="anchor" aria-hidden="true" href="#function-ckeq"><span aria-hidden="true" class="octicon octicon-link"></span></a>Function <code>c:keq</code>
</h5>
<p>This function compares the first argument with an infinite number of SDL2 Scancodes, if any of them matched, it will return <code>T</code>.</p>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">on-keyup</span> (key) <span class="pl-c"><span class="pl-c">;</span>; keyup handler for evil vimers</span>
  (<span class="pl-c1">cond</span>
    ((c:keq key :scancode-left :scancode-h)
     (<span class="pl-c1">format</span> <span class="pl-c1">t</span> <span class="pl-s"><span class="pl-pds">"</span>move left~%<span class="pl-pds">"</span></span>))
    ((c:keq key :scancode-right :scancode-l)
     (<span class="pl-c1">format</span> <span class="pl-c1">t</span> <span class="pl-s"><span class="pl-pds">"</span>move right~%<span class="pl-pds">"</span></span>))
    ((c:keq key :scancode-up :scancode-k)
     (<span class="pl-c1">format</span> <span class="pl-c1">t</span> <span class="pl-s"><span class="pl-pds">"</span>move up~%<span class="pl-pds">"</span></span>))
    ((c:keq key :scancode-down :scancode-j)
     (<span class="pl-c1">format</span> <span class="pl-c1">t</span> <span class="pl-s"><span class="pl-pds">"</span>move down~%<span class="pl-pds">"</span></span>))
    (<span class="pl-c1">t</span> (<span class="pl-c1">format</span> <span class="pl-c1">t</span> <span class="pl-s"><span class="pl-pds">"</span>I don't know what to do~%<span class="pl-pds">"</span></span>))))</pre></div>
<p>SDL2 Scancode: <a href="https://wiki.libsdl.org/SDL2/SDL_Scancode" rel="nofollow">https://wiki.libsdl.org/SDL2/SDL_Scancode</a></p>
<h5><a name="callback-on-mousewheel" class="anchor" aria-hidden="true" href="#callback-on-mousewheel"><span aria-hidden="true" class="octicon octicon-link"></span></a>Callback <code>on-mousewheel</code>
</h5>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">on-mousewheel</span> (x y direction)
  <span class="pl-c"><span class="pl-c">;</span>; your code here</span>
  )</pre></div>
<h5><a name="callback-on-mousemotion" class="anchor" aria-hidden="true" href="#callback-on-mousemotion"><span aria-hidden="true" class="octicon octicon-link"></span></a>Callback <code>on-mousemotion</code>
</h5>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">internal-on-mousemotion</span> (&amp;key x y)
  <span class="pl-c"><span class="pl-c">;</span>; your code here</span>
  )</pre></div>
<h5><a name="callback-on-mousebuttonup" class="anchor" aria-hidden="true" href="#callback-on-mousebuttonup"><span aria-hidden="true" class="octicon octicon-link"></span></a>Callback <code>on-mousebuttonup</code>
</h5>
<h5><a name="callback-on-mousebuttondown" class="anchor" aria-hidden="true" href="#callback-on-mousebuttondown"><span aria-hidden="true" class="octicon octicon-link"></span></a>Callback <code>on-mousebuttondown</code>
</h5>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">on-mousebuttonup</span> (&amp;key button x y clicks)
  <span class="pl-c"><span class="pl-c">;</span>; your code here</span>
  )
(<span class="pl-k">defun</span> <span class="pl-en">on-mousebuttondown</span> (&amp;key button x y clicks)
  <span class="pl-c"><span class="pl-c">;</span>; your code here</span>
  )</pre></div>
<h5><a name="callback-on-fingermotion" class="anchor" aria-hidden="true" href="#callback-on-fingermotion"><span aria-hidden="true" class="octicon octicon-link"></span></a>Callback <code>on-fingermotion</code>
</h5>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">on-fingermotion</span> (&amp;key x  y dx dy pressure finger-id)
  <span class="pl-c"><span class="pl-c">;</span>; your code here</span>
  )</pre></div>
<h5><a name="callback-on-fingerup" class="anchor" aria-hidden="true" href="#callback-on-fingerup"><span aria-hidden="true" class="octicon octicon-link"></span></a>Callback <code>on-fingerup</code>
</h5>
<h5><a name="callback-on-fingerdown" class="anchor" aria-hidden="true" href="#callback-on-fingerdown"><span aria-hidden="true" class="octicon octicon-link"></span></a>Callback <code>on-fingerdown</code>
</h5>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">on-fingerup</span> (&amp;key x  y dx dy pressure finger-id)
  <span class="pl-c"><span class="pl-c">;</span>; your code here</span>
  )
(<span class="pl-k">defun</span> <span class="pl-en">on-fingerdown</span> (&amp;key x  y dx dy pressure finger-id)
  <span class="pl-c"><span class="pl-c">;</span>; your code here</span>
  )</pre></div>
<h5><a name="callback-on-windowresized" class="anchor" aria-hidden="true" href="#callback-on-windowresized"><span aria-hidden="true" class="octicon octicon-link"></span></a>Callback <code>on-windowresized</code>
</h5>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">on-windowresized</span> (width height)
  <span class="pl-c"><span class="pl-c">;</span>; your code here</span>
  )</pre></div>
<h5><a name="callback-on-windowenter" class="anchor" aria-hidden="true" href="#callback-on-windowenter"><span aria-hidden="true" class="octicon octicon-link"></span></a>Callback <code>on-windowenter</code>
</h5>
<h5><a name="callback-on-windowleave" class="anchor" aria-hidden="true" href="#callback-on-windowleave"><span aria-hidden="true" class="octicon octicon-link"></span></a>Callback <code>on-windowleave</code>
</h5>
<p>These two callbacks do not take any arguments, for example:</p>
<div class="highlight highlight-source-lisp"><pre>(<span class="pl-k">defun</span> <span class="pl-en">on-windowenter</span> ()
  <span class="pl-c"><span class="pl-c">;</span>; your code here</span>
  )</pre></div>
<h4><a name="window-related" class="anchor" aria-hidden="true" href="#window-related"><span aria-hidden="true" class="octicon octicon-link"></span></a>Window Related</h4>
<h5><a name="variable-calm-window" class="anchor" aria-hidden="true" href="#variable-calm-window"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-window*</code>
</h5>
<p>This variable is readonly, it holds the created instance of <a href="https://wiki.libsdl.org/SDL2/SDL_Window" rel="nofollow">SDL_Window</a>.</p>
<p>With this variable, one could utilize all kinds of SDL2 window related functions, such as:</p>
<div class="highlight highlight-source-lisp"><pre><span class="pl-c"><span class="pl-c">;</span>; get window position</span>
(sdl2:get-window-position <span class="pl-smi">*calm-window*</span>)

<span class="pl-c"><span class="pl-c">;</span>; set window always on top</span>
(sdl2-ffi.functions:sdl-set-window-always-on-top
 <span class="pl-smi">*calm-window*</span>
 sdl2-ffi:+true+)</pre></div>
<h5><a name="variable-calm-window-x" class="anchor" aria-hidden="true" href="#variable-calm-window-x"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-window-x*</code>
</h5>
<h5><a name="variable-calm-window-y" class="anchor" aria-hidden="true" href="#variable-calm-window-y"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-window-y*</code>
</h5>
<p>The initial position (x, y) of your CALM application window.</p>
<p>Default: <code>:centered</code></p>
<h5><a name="variable-calm-window-flags" class="anchor" aria-hidden="true" href="#variable-calm-window-flags"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-window-flags*</code>
</h5>
<p>A list of <a href="https://wiki.libsdl.org/SDL2/SDL_WindowFlags" rel="nofollow">SDL_WindowFlags</a>.</p>
<p>You could set this value like: <code>(setf *calm-window-flags* '(:shown :allow-highdpi :resizable))</code></p>
<p>Default: <code>'(:shown :allow-highdpi)</code></p>
<h5><a name="variable-calm-window-width" class="anchor" aria-hidden="true" href="#variable-calm-window-width"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-window-width*</code>
</h5>
<h5><a name="variable-calm-window-height" class="anchor" aria-hidden="true" href="#variable-calm-window-height"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-window-height*</code>
</h5>
<h5><a name="variable-calm-window-title" class="anchor" aria-hidden="true" href="#variable-calm-window-title"><span aria-hidden="true" class="octicon octicon-link"></span></a>Variable <code>*calm-window-title*</code>
</h5>
<p>You know what these variables do.</p>
<p>If you don't, <a href="https://github.com/sponsors/VitoVan/">give me 5 bucks</a> and think harder.</p>
<h2><a name="tutorials" class="anchor" aria-hidden="true" href="#tutorials"><span aria-hidden="true" class="octicon octicon-link"></span></a>Tutorials</h2>
<p>Ok ok, I will write this, I will write this, just wait a second.</p>
<p>You could check these useful links while waiting:</p>
<ul>
<li>
<p>SDL2</p>
<ul>
<li><a href="https://wiki.libsdl.org/SDL2" rel="nofollow">https://wiki.libsdl.org/SDL2</a></li>
<li><a href="https://github.com/lispgames/cl-sdl2">https://github.com/lispgames/cl-sdl2</a></li>
</ul>
</li>
<li>
<p>Cairo</p>
<ul>
<li>
<p><a href="https://www.cairographics.org/" rel="nofollow">https://www.cairographics.org/</a></p>
</li>
<li>
<p><a href="https://github.com/rpav/cl-cairo2">https://github.com/rpav/cl-cairo2</a></p>
</li>
</ul>
</li>
<li>
<p>Development Tools</p>
<ul>
<li><a href="https://slime.common-lisp.dev/" rel="nofollow">https://slime.common-lisp.dev/</a></li>
<li><a href="https://lispcookbook.github.io/cl-cookbook/vscode-alive.html" rel="nofollow">https://lispcookbook.github.io/cl-cookbook/vscode-alive.html</a></li>
</ul>
</li>
<li>
<p>Common Lisp</p>
<ul>
<li><a href="https://lispcookbook.github.io/cl-cookbook/" rel="nofollow">https://lispcookbook.github.io/cl-cookbook/</a></li>
<li><a href="http://www.lispworks.com/documentation/HyperSpec/Front/" rel="nofollow">http://www.lispworks.com/documentation/HyperSpec/Front/</a></li>
<li><a href="https://lisp-lang.org/books/" rel="nofollow">https://lisp-lang.org/books/</a></li>
</ul>
</li>
</ul>
<h2><a name="license" class="anchor" aria-hidden="true" href="#license"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>
<p>The <a href="https://github.com/VitoVan/calm">source code</a> is released under GPL-2.0-only.</p>
</div>
        </div>
    </body>
</html>
